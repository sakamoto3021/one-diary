<div class="row">
<% if user_signed_in? %>
  <h1>Tweet一覧</h1>
  <div id="sidebar" class="col-sm-4">
    <div class="tweet-form">
      <%= form_with model: @tweet do |f| %>
        <%= f.text_area :content, placeholder: "ここからTweetしてみましょう！", class:'form-controll tweet-form', maxlength: '140' %>
        <%= f.submit '投稿する', class:'btn btn-block btn-default'%>
      <% end %>
    </div>

    <div class="form-group search-form">
      <%= search_form_for(@q, url: root_path) do |f| %>
        <p class="glyphicon glyphicon-search">範囲検索</p>
        <%= f.date_field :created_after, class:'form-control search-start' %>
        <%= f.date_field :created_before, class:'form-control search-end pull-right' %>
        <%= f.submit '検索', class:'btn-default pull-right' %>
      <% end %>
    </div>
  </div>
  <div id="preview">
    <%= render 'preview' %>
  </div>

  <div id="tweets" class="col-sm-8">
    <%= render 'tweets', tweets: @tweets %>
  </div>

  <% else %>

    <h1>トップページ</h1>
    <p>Twitterを日付ごとに保存</p>
    <p>日記のように読み返せるように</p>
  <% end %>
</div>

<a href="#" class="back-to-top">▲</a>

<script>
  // プレビュー表示
  $(document).ready(function() {
    $("textarea").keyup(function() {
      $(".preview-display > div").fadeIn(600);
      $("#main").html( $(this).val() );
    });
  });

  // プレビュー非表示
  $(document).ready(function() {
    $(".preview-hide").click(function() {
      $(".preview-display > div").hide();
    });
  });

  // トップに戻る
  function updateButton() {
    if ($(this).scrollTop() >= 200) {
      $(".back-to-top").fadeIn();
    } else {
      $(".back-to-top").fadeOut();
    }
  }

  $(document).ready(function() {
    updateButton();
    $(window).scroll(updateButton);
    $(".back-to-top").click(function() {
      $("html, body").animate( {
        scrollTop: 0
        }, 600 );
      return false
    });
  });
</script>
